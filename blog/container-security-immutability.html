<!DOCTYPE html>
<html>
    <head>
    <meta http-equiv="content-language" content="en">
    <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Container security and immutability</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Docker, container and immutability. Have an immutable system has advantages not only from deploy, release and scalability point of view but also from security side. Deploy and build a new release quickly and high frequency improve the way you trust your provisioning system. Have the old environment still running and ready to be rolled back is another good point.">
    <meta name="keywords" content="docker, scaledocker, security, docker captain, ebook, book, learn, deploy">
    <meta name="google-site-verification" content="FoOIQ005srOjHlH19pNWapHvlOOVgCqHsz47IfQ6QNo" />
    <link rel="canonical" href="https://gianarb.it/blog/container-security-immutability">
    <link rel="icon" type="image/png" href="/img/favicon.png" />

    <meta name='twitter:card' content='summary_large_image'>
    <meta name='twitter:title' content="Container security and immutability">
    <meta name='twitter:description' content="Docker, container and immutability. Have an immutable system has advantages not only from deploy, release and scalability point of view but also from security side. Deploy and build a new release quickly and high frequency improve the way you trust your provisioning system. Have the old environment still running and ready to be rolled back is another good point.">

    <meta property="og:title" content="Container security and immutability" />
    <meta property="og:site_name" content="gianarb blog"/>
    <meta property="og:url" content="https://gianarb.it/blog/container-security-immutability" />
    <meta property="og:description" content="Docker, container and immutability. Have an immutable system has advantages not only from deploy, release and scalability point of view but also from security side. Deploy and build a new release quickly and high frequency improve the way you trust your provisioning system. Have the old environment still running and ready to be rolled back is another good point." />
    <meta property="og:type" content="article" />
    <meta property="og:locale" content="en_US" />

    <meta property="og:image" content="https://gianarb.it/img/container-security.png" />
    <meta name='twitter:image' content="https://gianarb.it/img/container-security.png">



    <meta property="twitter:account_id" content="129952408" />
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@gianarb">
    <meta name="twitter:creator" content="@gianarb">
    <meta name="twitter:title" content="Container security and immutability">
    <meta name="twitter:description" content="Docker, container and immutability. Have an immutable system has advantages not only from deploy, release and scalability point of view but also from security side. Deploy and build a new release quickly and high frequency improve the way you trust your provisioning system. Have the old environment still running and ready to be rolled back is another good point.">
    <meta name="twitter:image:src" content="https://gianarb.it/img/container-security.png">
    <meta name="twitter:image:width" content="500">
    <meta name="twitter:image:height" content="500">
    <meta name="twitter:domain" content="gianarb.it">

    <link rel='alternate' type='application/atom+xml' title='Atom 0.3' href='/atom.xml'>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" rel="stylesheet">

    <!-- source https://github.com/rsms/inter/ -->
    <link href="/fonts/inter/inter-ui.css" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/main.css">

</head>

    <body>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark" role="navigation">
    <div class="container-fluid">
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="navbar-brand" href="#">
        <a href="/" class="nav-link">
          <img src="/img/favicon.png" class="img-fluid d-inline-block align-top" alt="">
        </a>
      </div>

      <div class="collapse navbar-collapse">
        <ul class="navbar-nav">
          <li><a class="nav-link" href="/">Home</a></li>
          <li><a class="nav-link" href="/blog.html">Blog</a></li>
          <li class="nav-item"><a href="/conferences.html" class="nav-link">Conferences</a></li>
        </ul>

        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CE7DLK7L&placement=gianarbit" id="_carbonads_js"></script>
          </li>
        </ul>

      </div>

    </div>
</nav>

        

<div class="container">

    <div class="content">

        <div class="row">
            <div id="post-title" class="mt-5 col-md-12">
                <h1>Container security and immutability</h1>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <p class="meta">05 Jun 2017 · <!-- thanks to https://www.davidputney.com/2016/07/how-medium-style-read-time-estimate.html -->


<span class="blog-read-time">Four minute read</span>
 · docker, scaledocker, security, docker captain, ebook, book, learn, deploy</p>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="addthis_sharing_toolbox"></div>
            </div>
        </div>

        <div class="row mt-3">
            <div class="col-md-12">
            <blockquote class="twitter-tweet tw-align-center" data-lang="en"><p lang="en" dir="ltr">55 pages
about how to improve container security. <a href="https://twitter.com/ciliumproject">@ciliumproject</a> <a href="https://twitter.com/hashtag/BPF?src=hash">#BPF</a>, best practices, <a href="https://twitter.com/coreos">@coreos</a> clair, <a href="https://twitter.com/hashtag/apparmor?src=hash">#apparmor</a> <a href="https://t.co/ABiuldYA9b">https://t.co/ABiuldYA9b</a> <a href="https://t.co/61jzWxzb1Y">pic.twitter.com/61jzWxzb1Y</a></p>&mdash; :w
!sudo tee % (@GianArb) <a href="https://twitter.com/GianArb/status/871808740080615424">June 5,
2017</a></blockquote>
<script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>Security is a fascinating topic.
It’s part of every aspect of a system.
From your email server to the HTTP body validation of your API system.</p>

<p>It’s also a very human centric topic. You can use the most stronger security
approaches but if your rules are too hard to follow or too complicated to
implement the end users or your colleagues will become the perfect breach to be
exploited by bad people.</p>

<p>In distributed systems there are interesting challenges like:</p>

<ul>
  <li>How can we trust the instances part of the system itself? I mean, how can we
trust a new application after a pool scale?</li>
  <li>All the traffic generated by the system needs to be locked. The network
topology grows with the number of services that we add but that’s not a good
excuse to leak on responsibility about how we do manage our network.</li>
</ul>

<p>When you design a system you need to think about security from different points
of view:</p>

<ul>
  <li>Security needs to be efficient. This seems obvious but it’s always something
to keep in mind.</li>
  <li>It needs to be easy to use in development mode. As we said before. If security
is making things slower somebody will turn it off.</li>
  <li>If you are good enough to make it easy, it will be easier to enforce a secure behavior.</li>
</ul>

<p>All this concepts are well applied in all different projects built by the Docker
Community.
Notary, swarmkit are just a few examples but if you think about the update
framework (TUF) and the whole set of things happening behind every <code class="highlighter-rouge">docker push</code> and <code class="highlighter-rouge">pull</code>
command you suddenly see a great example on how to make complicated things really easy to use.</p>

<p>I published an ebook that you can download for free <a href="/blog/scaledocker">here</a>.
It contains ~55 pages about Container and Docker Security. In this article I
will share one of the concept expressed in that book, <strong>Immutability</strong>.</p>

<p>Docker containers are in fact immutable.  This means that a running container
never changes because in case you need to update it, the best practice is to
create a new container with the updated version of your application and delete
the old one.</p>

<p>This aspect is important from different point of views.</p>

<p>Immutability applied to deploy is a big challenge because it opens the door to a very
different set of release strategies like blue green deployment or canary releases.
Immutability also lowers rollback times because you can probably keep the
old version running for a little longer and switch traffic in case of problems.</p>

<p>It’s also a plus from a scalability and stability point of view. For each deploy
you are in fact using provisioning scripts and build tools to package and
release a new version of your application. You are creating new nodes to replace
the old ones that means that you are focused on provisioning and configuration
management. You are justifying all the effort spent to implement infrastructure
as code.</p>

<p>It matters also for security because you will have a fresh container after each
update and in the case of a vulnerability or injection they will be cleaned
during the update.</p>

<p>You have also an instrument to analyse the attacked container with the command
docker diff <container_id> This command shows the differences in the file system.</container_id></p>

<p>It supports 3 events:</p>

<ul>
  <li>A - Add</li>
  <li>D - Delete</li>
  <li>C - Change</li>
</ul>

<p>In case of attack, you can commit the attacked container to analyse it later and
replace it with the original image.</p>

<p>This flow is interesting but if you know that your application does not need to
modify the file system you can use <code class="highlighter-rouge">–read-only</code> parameters to make the fs read
only or you can share a volume with the <code class="highlighter-rouge">ro</code> suffix <code class="highlighter-rouge">-v PWD:/data:ro</code>.</p>

<p>Docker can’t fix the security issues for you, if your application can be
attacked by a code injection then you need to fix your app but Docker offers a
few utilities to make life hard for an hacker and to allow you to have more
control over your environment.</p>

<p>During this chapter we covered some practices and tools that you can follow or
use to build a safe environment.</p>

<p>In general, you need to close your application in an environment that provides
only what you need and what you know.</p>

<p>If your distribution or your container has something that you don’t have under
your control or it is unused then it is a good idea remove these dark points.</p>

<p>That’s all. Immutability is not free and it requires to keep all the tools and
processes involved in deploy, packaging up to speed because all your production
environment depends on these tools. But it’s an important piece of the puzzle.
To read more about tools like Cilium, CoreOS Clair, best practices about
registry and images you can download the pdf <a href="/blog/scaledocker">Play Safe with Docker and
Container Security</a>.</p>

            </div>
        </div>

        <div class="row mt-3">
            <div class="col-md-12">
                <div id="disqus_thread"></div>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </div>
        </div>

    </div>
</div>

<script>
var disqus_config = function () {
    this.page.url = 'https://gianarb.it/blog/container-security-immutability';
    this.page.identifier = 'https://gianarb.it/blog/container-security-immutability';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://gianarbdeveloper.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>

        <div class="footer text-center bg-dark text-light">
    <div class="container">
        <div class="row">
            <div class="col-md-12 small">
                last update December 22, 2020 ·
                <a href="https://twitter.com/gianarb" target="_blank">twitter.com/gianarb</a> ·
                <a href="https://github.com/gianarb" target="_blank">github.com/gianarb</a> ·
                <a href="https://twitch.tv/gianarb" target="_blank">twitch.tv/gianarb</a> ·
                <a href="/atom.xml">Atom</a>
            </div>
        </div>
    </div>
</div>

        <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/bash.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/dockerfile.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/go.min.js"></script>
        <script src="/js/custom.js"></script>

        <script>hljs.initHighlightingOnLoad();</script>
    </body>
</html>
