<!DOCTYPE html>
<html>
    <head>
    <meta http-equiv="content-language" content="en">
    <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Reactive planing in Golang. Reach a desired number adding and subtracting random numbers</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="An example about how to write reactive planning in Go. Code and step by step solution for an exercise I developed to learn planner">
    <meta name="keywords" content="software design, golang, go, reconciliation loop, reactive planning">
    <meta name="google-site-verification" content="FoOIQ005srOjHlH19pNWapHvlOOVgCqHsz47IfQ6QNo" />
    <link rel="canonical" href="https://gianarb.it/blog/reactive-plan-golang-example">
    <link rel="icon" type="image/png" href="/img/favicon.png" />

    <meta name='twitter:card' content='summary_large_image'>
    <meta name='twitter:title' content="Reactive planing in Golang. Reach a desired number adding and subtracting random numbers">
    <meta name='twitter:description' content="An example about how to write reactive planning in Go. Code and step by step solution for an exercise I developed to learn planner">

    <meta property="og:title" content="Reactive planing in Golang. Reach a desired number adding and subtracting random numbers" />
    <meta property="og:site_name" content="gianarb blog"/>
    <meta property="og:url" content="https://gianarb.it/blog/reactive-plan-golang-example" />
    <meta property="og:description" content="An example about how to write reactive planning in Go. Code and step by step solution for an exercise I developed to learn planner" />
    <meta property="og:type" content="article" />
    <meta property="og:locale" content="en_US" />


    <meta property="og:image" content="" />
    <meta name='twitter:image' content="https://gianarb.it/img/steel-iron-metal.jpg">


    <meta property="twitter:account_id" content="129952408" />
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@gianarb">
    <meta name="twitter:creator" content="@gianarb">
    <meta name="twitter:title" content="Reactive planing in Golang. Reach a desired number adding and subtracting random numbers">
    <meta name="twitter:description" content="An example about how to write reactive planning in Go. Code and step by step solution for an exercise I developed to learn planner">
    <meta name="twitter:image:src" content="https://gianarb.it">
    <meta name="twitter:image:width" content="500">
    <meta name="twitter:image:height" content="500">
    <meta name="twitter:domain" content="gianarb.it">

    <link rel='alternate' type='application/atom+xml' title='Atom 0.3' href='/atom.xml'>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" rel="stylesheet">

    <!-- source https://github.com/rsms/inter/ -->
    <link href="/fonts/inter/inter-ui.css" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/main.css">

</head>

    <body>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark" role="navigation">
    <div class="container-fluid">
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="navbar-brand" href="#">
        <a href="/" class="nav-link">
          <img src="/img/favicon.png" class="img-fluid d-inline-block align-top" alt="">
        </a>
      </div>

      <div class="collapse navbar-collapse">
        <ul class="navbar-nav">
          <li><a class="nav-link" href="/">Home</a></li>
          <li><a class="nav-link" href="/blog.html">Blog</a></li>
          <li class="nav-item"><a href="/conferences.html" class="nav-link">Conferences</a></li>
        </ul>

        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CE7DLK7L&placement=gianarbit" id="_carbonads_js"></script>
          </li>
        </ul>

      </div>

    </div>
</nav>

        
<style>
.bgimage {
  background-image: url('/img/steel-iron-metal.jpg');
}
</style>
<section class="bgimage">
</section>


<div class="container">

    <div class="content">

        <div class="row">
            <div id="post-title" class="mt-5 col-md-12">
                <h1>Reactive planing in Golang. Reach a desired number adding and subtracting random numbers</h1>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <p class="meta">26 Oct 2020 · <!-- thanks to https://www.davidputney.com/2016/07/how-medium-style-read-time-estimate.html -->


<span class="blog-read-time">Nine minute read</span>
 · software design, golang, go, reconciliation loop, reactive planning</p>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="addthis_sharing_toolbox"></div>
            </div>
        </div>

        <div class="row mt-3">
            <div class="col-md-12">
            <p>Ciao! A few months ago, probably a year, I wrote a small library called
<a href="https://github.com/gianarb/planner">planner</a>. It comes from my experience using
reactive planning and Kubernetes. I am really in love with this way of writing
code because it sounds very reliable to me.</p>

<p>Over the last couple of days, I decided to write documentation for it! So now it
is presentable; I streamed that with <a href="https://twitch.tv/gianarb">Twitch</a> if you
like to watch people coding!</p>

<p>As part of the library’s readme, I wrote a small program, and I left a couple of
exercises to the reader. With this article, I want to solve them.</p>

<p>You can follow this article and try it yourself, starting from
<a href="https://play.golang.com/p/0LuIoMtp10f">play.golang.com</a>.</p>

<div class="language-golang highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span><span class="x"> </span><span class="n">main</span><span class="x">

</span><span class="k">import</span><span class="x"> </span><span class="p">(</span><span class="x">
	</span><span class="s">"context"</span><span class="x">
	</span><span class="s">"time"</span><span class="x">

	</span><span class="s">"github.com/gianarb/planner"</span><span class="x">
	</span><span class="s">"go.uber.org/zap"</span><span class="x">
</span><span class="p">)</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">ctx</span><span class="p">,</span><span class="x"> </span><span class="n">done</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">context</span><span class="o">.</span><span class="n">WithTimeout</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">Background</span><span class="p">(),</span><span class="x"> </span><span class="m">10</span><span class="o">*</span><span class="n">time</span><span class="o">.</span><span class="n">Second</span><span class="p">)</span><span class="x">
	</span><span class="k">defer</span><span class="x"> </span><span class="n">done</span><span class="p">()</span><span class="x">

	</span><span class="n">countPlan</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="o">&amp;</span><span class="n">CountPlan</span><span class="p">{</span><span class="x">
		</span><span class="n">Target</span><span class="o">:</span><span class="x"> </span><span class="m">20</span><span class="p">,</span><span class="x">
	</span><span class="p">}</span><span class="x">
	</span><span class="n">scheduler</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">planner</span><span class="o">.</span><span class="n">NewScheduler</span><span class="p">()</span><span class="x">
	</span><span class="n">scheduler</span><span class="o">.</span><span class="n">WithLogger</span><span class="p">(</span><span class="n">initLogger</span><span class="p">())</span><span class="x">

	</span><span class="n">scheduler</span><span class="o">.</span><span class="n">Execute</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span><span class="x"> </span><span class="n">countPlan</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="k">type</span><span class="x"> </span><span class="n">CountPlan</span><span class="x"> </span><span class="k">struct</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">Target</span><span class="x">  </span><span class="kt">int</span><span class="x">
	</span><span class="n">current</span><span class="x"> </span><span class="kt">int</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="p">(</span><span class="n">p</span><span class="x"> </span><span class="o">*</span><span class="n">CountPlan</span><span class="p">)</span><span class="x"> </span><span class="n">Create</span><span class="p">(</span><span class="n">ctx</span><span class="x"> </span><span class="n">context</span><span class="o">.</span><span class="n">Context</span><span class="p">)</span><span class="x"> </span><span class="p">([]</span><span class="n">planner</span><span class="o">.</span><span class="n">Procedure</span><span class="p">,</span><span class="x"> </span><span class="kt">error</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="k">if</span><span class="x"> </span><span class="n">p</span><span class="o">.</span><span class="n">current</span><span class="x"> </span><span class="o">&lt;</span><span class="x"> </span><span class="n">p</span><span class="o">.</span><span class="n">Target</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="k">return</span><span class="x"> </span><span class="p">[]</span><span class="n">planner</span><span class="o">.</span><span class="n">Procedure</span><span class="p">{</span><span class="o">&amp;</span><span class="n">AddNumber</span><span class="p">{</span><span class="n">plan</span><span class="o">:</span><span class="x"> </span><span class="n">p</span><span class="p">}},</span><span class="x"> </span><span class="no">nil</span><span class="x">
	</span><span class="p">}</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="no">nil</span><span class="p">,</span><span class="x"> </span><span class="no">nil</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="p">(</span><span class="n">p</span><span class="x"> </span><span class="o">*</span><span class="n">CountPlan</span><span class="p">)</span><span class="x"> </span><span class="n">Name</span><span class="p">()</span><span class="x"> </span><span class="kt">string</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="s">"count_plan"</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="k">type</span><span class="x"> </span><span class="n">AddNumber</span><span class="x"> </span><span class="k">struct</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">plan</span><span class="x"> </span><span class="o">*</span><span class="n">CountPlan</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="p">(</span><span class="n">a</span><span class="x"> </span><span class="o">*</span><span class="n">AddNumber</span><span class="p">)</span><span class="x"> </span><span class="n">Name</span><span class="p">()</span><span class="x"> </span><span class="kt">string</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="s">"add_number"</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="p">(</span><span class="n">a</span><span class="x"> </span><span class="o">*</span><span class="n">AddNumber</span><span class="p">)</span><span class="x"> </span><span class="n">Do</span><span class="p">(</span><span class="n">ctx</span><span class="x"> </span><span class="n">context</span><span class="o">.</span><span class="n">Context</span><span class="p">)</span><span class="x"> </span><span class="p">([]</span><span class="n">planner</span><span class="o">.</span><span class="n">Procedure</span><span class="p">,</span><span class="x"> </span><span class="kt">error</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">a</span><span class="o">.</span><span class="n">plan</span><span class="o">.</span><span class="n">current</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">a</span><span class="o">.</span><span class="n">plan</span><span class="o">.</span><span class="n">current</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="m">1</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="no">nil</span><span class="p">,</span><span class="x"> </span><span class="no">nil</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">initLogger</span><span class="p">()</span><span class="x"> </span><span class="o">*</span><span class="n">zap</span><span class="o">.</span><span class="n">Logger</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">cfg</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">zap</span><span class="o">.</span><span class="n">NewProductionConfig</span><span class="p">()</span><span class="x">
	</span><span class="n">cfg</span><span class="o">.</span><span class="n">Encoding</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="s">"console"</span><span class="x">
	</span><span class="n">l</span><span class="p">,</span><span class="x"> </span><span class="n">_</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">cfg</span><span class="o">.</span><span class="n">Build</span><span class="p">()</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="n">l</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre></div></div>

<p>This program tries to reach the <code class="highlighter-rouge">Target</code> (20 in this case) adding numbers to the
current state. If you execute this program as it is you will get the following
logs:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">1.257894e+09	info	planner@v0.0.1/scheduer.go:41	Started execution plan count_plan	{"execution_id": "98d28eed-9b3b-4ad8-bfbd-1b5338d1a649"}
1.257894e+09	info	planner@v0.0.1/scheduer.go:59	Plan executed without errors.	{"execution_id": "98d28eed-9b3b-4ad8-bfbd-1b5338d1a649", "execution_time": "0s", "step_executed": 20}
</span></code></pre></div></div>

<p>As you can see, the scheduler executed the plan <code class="highlighter-rouge">count_plan</code> successfully, and
it took 20 steps to get there (<code class="highlighter-rouge">step_executed: 20</code>).</p>

<p>Reasonable because, as you can see, the <code class="highlighter-rouge">CounterPlan.Create</code> function returns an
<code class="highlighter-rouge">AddNumber</code> procedure and that procedure only adds 1 to the current state. It is
just a counter; let’s make it a bit more fun. I want to add or substract random
number until the target is reached. The program adds when the current state is above the
target, when above it subtracts. If it’s equal we are done. This is a simple way
to simulate something that has to adapt, too simple to sound cool but still
something understandable.</p>

<h3 id="change-the-addnumber-to-use-a-randomly-generated-number">Change the AddNumber to use a randomly generated number.</h3>

<p>We need to change the AddNumber in order to add not 1 but a random number. Let’s
do it:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span><span class="x"> </span><span class="n">random</span><span class="x"> </span><span class="o">*</span><span class="n">rand</span><span class="o">.</span><span class="n">Rand</span><span class="x">
</span><span class="k">func</span><span class="x"> </span><span class="n">initRandom</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
    </span><span class="n">s1</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">rand</span><span class="o">.</span><span class="n">NewSource</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">Now</span><span class="p">()</span><span class="o">.</span><span class="n">UnixNano</span><span class="p">())</span><span class="x">
    </span><span class="n">random</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">rand</span><span class="o">.</span><span class="n">New</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre></div></div>

<p>At this point, we can use <code class="highlighter-rouge">random</code> as part of the <code class="highlighter-rouge">AddNumber.Do</code> function.</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span><span class="x"> </span><span class="n">AddNumber</span><span class="x"> </span><span class="k">struct</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">plan</span><span class="x"> </span><span class="o">*</span><span class="n">CountPlan</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="p">(</span><span class="n">a</span><span class="x"> </span><span class="o">*</span><span class="n">AddNumber</span><span class="p">)</span><span class="x"> </span><span class="n">Name</span><span class="p">()</span><span class="x"> </span><span class="kt">string</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="s">"add_number"</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="p">(</span><span class="n">a</span><span class="x"> </span><span class="o">*</span><span class="n">AddNumber</span><span class="p">)</span><span class="x"> </span><span class="n">Do</span><span class="p">(</span><span class="n">ctx</span><span class="x"> </span><span class="n">context</span><span class="o">.</span><span class="n">Context</span><span class="p">)</span><span class="x"> </span><span class="p">([]</span><span class="n">planner</span><span class="o">.</span><span class="n">Procedure</span><span class="p">,</span><span class="x"> </span><span class="kt">error</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">a</span><span class="o">.</span><span class="n">plan</span><span class="o">.</span><span class="n">current</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">a</span><span class="o">.</span><span class="n">plan</span><span class="o">.</span><span class="n">current</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="n">random</span><span class="o">.</span><span class="n">Intn</span><span class="p">(</span><span class="m">10</span><span class="p">)</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="no">nil</span><span class="p">,</span><span class="x"> </span><span class="no">nil</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre></div></div>

<p>For simplicity, I am taking a random number between 0 and 10. What happens now?
The problem now is that we can go above the target, so we have to make our
<code class="highlighter-rouge">CounterPlan.Create</code> function and our logic a bit more complicated.</p>

<h2 id="evolve-the-create-function-to-subtract-numbers-from-the-current-state">Evolve the Create function to subtract numbers from the current state</h2>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span><span class="x"> </span><span class="p">(</span><span class="n">p</span><span class="x"> </span><span class="o">*</span><span class="n">CountPlan</span><span class="p">)</span><span class="x"> </span><span class="n">Create</span><span class="p">(</span><span class="n">ctx</span><span class="x"> </span><span class="n">context</span><span class="o">.</span><span class="n">Context</span><span class="p">)</span><span class="x"> </span><span class="p">([]</span><span class="n">planner</span><span class="o">.</span><span class="n">Procedure</span><span class="p">,</span><span class="x"> </span><span class="kt">error</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="k">if</span><span class="x"> </span><span class="n">p</span><span class="o">.</span><span class="n">current</span><span class="x"> </span><span class="o">&lt;</span><span class="x"> </span><span class="n">p</span><span class="o">.</span><span class="n">Target</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="k">return</span><span class="x"> </span><span class="p">[]</span><span class="n">planner</span><span class="o">.</span><span class="n">Procedure</span><span class="p">{</span><span class="o">&amp;</span><span class="n">AddNumber</span><span class="p">{</span><span class="n">plan</span><span class="o">:</span><span class="x"> </span><span class="n">p</span><span class="p">}},</span><span class="x"> </span><span class="no">nil</span><span class="x">
	</span><span class="p">}</span><span class="x"> </span><span class="k">else</span><span class="x"> </span><span class="k">if</span><span class="x"> </span><span class="n">p</span><span class="o">.</span><span class="n">current</span><span class="x"> </span><span class="o">&gt;</span><span class="x"> </span><span class="n">p</span><span class="o">.</span><span class="n">Target</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="k">return</span><span class="x"> </span><span class="p">[]</span><span class="n">planner</span><span class="o">.</span><span class="n">Procedure</span><span class="p">{</span><span class="o">&amp;</span><span class="n">SubtractNumber</span><span class="p">{</span><span class="n">plan</span><span class="o">:</span><span class="x"> </span><span class="n">p</span><span class="p">}},</span><span class="x"> </span><span class="no">nil</span><span class="x">
	</span><span class="p">}</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="no">nil</span><span class="p">,</span><span class="x"> </span><span class="no">nil</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre></div></div>

<p>When we go above the target, the Plan subtracts a random number, and it keeps
going until we get to it. <code class="highlighter-rouge">SubtractNumber</code> does the opposite of what
<code class="highlighter-rouge">AddNumber</code> does, it subtracts a random number between 0 an 10.</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span><span class="x"> </span><span class="n">SubtractNumber</span><span class="x"> </span><span class="k">struct</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">plan</span><span class="x"> </span><span class="o">*</span><span class="n">CountPlan</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="p">(</span><span class="n">a</span><span class="x"> </span><span class="o">*</span><span class="n">SubtractNumber</span><span class="p">)</span><span class="x"> </span><span class="n">Name</span><span class="p">()</span><span class="x"> </span><span class="kt">string</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="s">"subtract_number"</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="p">(</span><span class="n">a</span><span class="x"> </span><span class="o">*</span><span class="n">SubtractNumber</span><span class="p">)</span><span class="x"> </span><span class="n">Do</span><span class="p">(</span><span class="n">ctx</span><span class="x"> </span><span class="n">context</span><span class="o">.</span><span class="n">Context</span><span class="p">)</span><span class="x"> </span><span class="p">([]</span><span class="n">planner</span><span class="o">.</span><span class="n">Procedure</span><span class="p">,</span><span class="x"> </span><span class="kt">error</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">a</span><span class="o">.</span><span class="n">plan</span><span class="o">.</span><span class="n">current</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">a</span><span class="o">.</span><span class="n">plan</span><span class="o">.</span><span class="n">current</span><span class="x"> </span><span class="o">-</span><span class="x"> </span><span class="n">random</span><span class="o">.</span><span class="n">Intn</span><span class="p">(</span><span class="m">10</span><span class="p">)</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="no">nil</span><span class="p">,</span><span class="x"> </span><span class="no">nil</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre></div></div>

<p>You can run the result <a href="https://play.golang.com/p/JDuizzUI86M">here</a>, and you
will see that based on the random numbers, it adds or subtracts the number of
executed steps changes.</p>

<p>NOTE: the golang playground always starts from the same time; in my example, I
use time as Seed; for this reason, to see a variation in the number of steps,
you will have to run the code locally.</p>

<h2 id="conclusion">Conclusion</h2>

<p>This is probably a too straightforward example, but let’s imagine that
your Target is not fixed and varies based on external factors. Your house’s
temperature and this program is a thermostat that has to keep your room at the
desired temperature. Or the number of instances running in your cloud provider,
and you have to keep them balanced. This last use case is the exact problem I
solved writing <a href="https://github.com/gianarb/keepit">keepit</a> a replica set for
<a href="https://metal.equinix.com">Equinix Metal</a> servers. I used planner, so check it out.</p>

<p>I didn’t highlight this example because this pattern gives you an excellent way
to measure how reliable your program is. Think about it in this way; you can
programmatically handle errors returning a procedure or more than one that can
mitigate the error itself. It can be a “sleep for 5 minutes and retry”, or you
can do something more complicated, and until the Plan keeps returning work to
do, you will have the opportunity to succeed. I extracted an highlight from the
<a href="https://www.twitch.tv/videos/780401570">Twitch stream</a> rambling about this.</p>

<p>Have a nice week!</p>

            </div>
        </div>

        <div class="row mt-3">
            <div class="col-md-12">
                <div id="disqus_thread"></div>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </div>
        </div>

    </div>
</div>

<script>
var disqus_config = function () {
    this.page.url = 'https://gianarb.it/blog/reactive-plan-golang-example';
    this.page.identifier = 'https://gianarb.it/blog/reactive-plan-golang-example';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://gianarbdeveloper.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>

        <div class="footer text-center bg-dark text-light">
    <div class="container">
        <div class="row">
            <div class="col-md-12 small">
                last update December 22, 2020 ·
                <a href="https://twitter.com/gianarb" target="_blank">twitter.com/gianarb</a> ·
                <a href="https://github.com/gianarb" target="_blank">github.com/gianarb</a> ·
                <a href="https://twitch.tv/gianarb" target="_blank">twitch.tv/gianarb</a> ·
                <a href="/atom.xml">Atom</a>
            </div>
        </div>
    </div>
</div>

        <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/bash.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/dockerfile.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/go.min.js"></script>
        <script src="/js/custom.js"></script>

        <script>hljs.initHighlightingOnLoad();</script>
    </body>
</html>
